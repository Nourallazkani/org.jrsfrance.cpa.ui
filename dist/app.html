<template>
  <require from="/assets/css/common/common.css"></require>
  <require from="/assets/css/common/common-modal-dialog.css"></require>
  <require from="/assets/css/common/common-form.css"></require>
  <require from="/assets/css/common/common-search-results.css"></require>
  <require from="/assets/css/specific/app.css"></require>
  
  <!-- sign-in-modal-->
  <div class="modal ${authz.action!=null && !authz.silent ? 'modal-visible' : 'modal-hidden'}">
    <div class="modal-dialog">
      <div class="modal-dialog-header">
        <div>Connexion</div>
        <div>
          <a click.trigger="cancelSignIn()" class="close"></a>
        </div>
      </div>
      <div class="modal-dialog-body" style="height:200px">
        <div if.bind="authz.action=='sign-in'">

          <form class="default-form" submit.delegate="processSignIn()" if.bind="authz.outcome==null">
            <div class="form-entry">
              <label class="width-lg-20">Adresse mail</label>
              <div class="input-container width-lg-80">
                <input type="text" value.bind="authz.input.mailAddress" />
              </div>
            </div>
            <div class="form-entry">
              <label class="width-lg-20">Mot de passe</label>
              <div class="input-container width-lg-80">
                <input type="password" value.bind="authz.input.password" />
              </div>
            </div>

            <div class="form-entry">
              <label class="width-lg-20">&nbsp;</label>
              <div class="input-container width-lg-80">
                <input type="checkbox" checked.bind="authz.rememberMe" /> se souvenir de moi
              </div>
            </div>
            <div class="form-entry">
              <label class="width-lg-20">&nbsp;</label>
              <div class="input-container width-lg-80">
                <button>Connexion</button>
              </div>
            </div>
          </form>

          <div if.bind="authz.outcome=='failure'" style="text-align:center">
            <div class="red-alert" style="margin-bottom:25px">L'authentification a échouée.</div>
            Voulez vous :
            <ul style="text-align:left">
              <li style="margin:20px auto"><a click.delegate="authz.outcome=null">Réessayer de vous authentifier</a></li>
              <li style="margin:20px auto"><a click.delegate="startPasswordRecoveryRequest()">Réinitialiser votre mot de passe</a></li>
            </ul>
          </div>

        </div>

        <div if.bind="authz.action=='recover-password'">
          <div if.bind="authz.outcome==null">
            <form class="default-form" submit.delegate="processPasswordRecovery()" if.bind="authz.outcome==null">
              <div class="form-entry">
                <label class="width-lg-20">Adresse mail</label>
                <div class="input-container width-lg-80">
                  <input type="text" value.bind="authz.input.mailAddress" />
                </div>
              </div>
              <div class="form-entry">
                <label class="width-lg-20">&nbsp;</label>
                <div class="input-container width-lg-80">
                  <button>Réinitialiser mont mot de passe</button>
                </div>
              </div>
            </form>
          </div>
          <div if.bind="authz.outcome=='accepted'" style="text-align:center">
            <p>Un mail vous a été envoyé, il contient un lien permettant de réinitialiser votre mot de passe.</p>
            <button click.delegate="cancelSignIn()">Fermer</button>
          </div>
        </div>



      </div>
      <div class="modal-dialog-footer"></div>
    </div>
  </div>
  <!-- end sign-in-modal-->

  <!-- header -->

  <header class="main-menu">
    <div class="languages">
      <a click.delegate="userDetails.language='fr'">FR </a> |
      <a click.delegate="userDetails.language='en'"> EN </a> |
      <a click.delegate="userDetails.language='ar'"> ع </a> |
      <a click.delegate="userDetails.language='prs'"> درى </a>
    </div>

    <div class="logo">
      <a route-href="route: home"> <img style="width:100px; height:80px;" src="/assets/img/logo.svg" alt="Logo" title="Comprendre pour Apprendre" /> </a>
    </div>

    <div class="menu-items" if.bind="userDetails.account!=null">
      <p>Hello ${userDetails.account.name} </p>
      <a href="#"> Mon profil</a> <a href="#"> Mon Calandrier</a>
      <a click.delegate="signOut()"> Deconnexion </a>
    </div>

    <div class="menu-items" if.bind="userDetails.account==null && router.currentInstruction.config.name!='home'">
      <button class="button-test"> S'inscrire</button>
      <button click.delegate="startSignIn()" if.bind="userDetails.profile!=null"> Connexion </button>
    </div>
  </header>

  <router-view></router-view>
</template>